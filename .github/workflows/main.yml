name: Verilog Simulation

on: 
  push:
  workflow_dispatch: # 버튼으로도 실행 가능하게 설정

jobs:
  run-simulation:
    runs-on: ubuntu-latest
    steps:
      # 1. 코드 가져오기
      - name: Checkout Code
        uses: actions/checkout@v3

      # 2. 시뮬레이터(Icarus Verilog) 설치
      - name: Install Icarus Verilog
        run: |
          sudo apt-get update
          sudo apt-get install -y iverilog

      # 3. 컴파일 (src 폴더와 test 폴더에 있는 모든 .v 파일 합치기)
      - name: Compile Verilog
        run: |
          echo "Compiling..."
          iverilog -o uart_sim.out src/*.v test/*.v

      # 4. 시뮬레이션 실행 (결과 출력)
      - name: Run Simulation
        run: |
          echo "Running Simulation..."
          vvp uart_sim.out
